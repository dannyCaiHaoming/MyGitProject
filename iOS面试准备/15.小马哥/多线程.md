





### 锁



#### OSSpinLock：自旋锁

- 等待锁的线程会处于忙等的状态，一直占用CPU资源
- 目前不安全，可能存在优先级反转
  - 线程1优先级高，线程2优先级低，线程2先加锁，线程1进来会先尝试获取锁从而忙等了，线程2反而无法有时间工作，线程2无法完成工作。

```objective-c
#import <libkern/OSAtomic.h>

OSSpinLock lock = OS_SPINLOCK_INIT; // C语言属性，要用assign

OSSpinLockLock(&lock);

OSSpinLockUnlock(&lock);
```



