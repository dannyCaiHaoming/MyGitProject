### 1. 资料收集



#### 存活主机&端口扫描：



##### 1.namp

1. ###### 主机发现：

```
-PS Syn Ping,那就是TCP
-PA ask Ping，也是TCP
-PU ping udp，
-PE  #ICMP PING，很多主机都封锁了，适用于管理员监视内部

-n 不对活动的ip进行反向域名解析，提高扫描速度
-R 对活动的IP进行反向域名解析
```

默认主机发现命令：

```sh
nmap xxx.xxx.xxx.1-255
```

Nmap会发送一个ICMP的echo请求，一个TCP SYN包给443端口，一个TCP ACK包给80端口，一个ICMP时间戳请求。

会返回一个IP地址段中活动的主机，IP地址，主机域名，开启的服务以及相应的端口，MAC地址等。

其他命令：

```sh
nmap -sP xxx.xxx.xxx.xxx # ping扫描，只列出存活主机
namp -Pn xxx.xxx.xxx.xxx # 无ping扫描，结果和默认主机发现一样
```

其他参数：

```sh
-O # 启用操作系统检测
-sV # 探测服务版本信息
-v # 啰嗦模式
--script=script_name # nse脚本
```



##### 2. 端口扫描

```sh
nmap -p 1-65535 xxx.xxx.xxx.xxx #-p 扫描指定端口
```

###### 1.常用扫描参数：

```sh
-sT #扫描用TCP连接
-sS #扫描用syn
-sU #扫描用UDP
-sA #扫描用ACK
-sF #扫描用FIN
```



###### 2.nmap识别的6种端口状态：

- open：应用程序使用该端口接受TCP或UDP报文

- close：nmap能收到响应，但是没有应用在此端口监听

- filtered（被过滤）：探测报文被过滤，nmap无法确认端口是否开放。过滤设备可能是`专业防火墙设备`，`路由规则`或`主机上的软件防火墙`

- unfiltered：未被过滤状态意味着端口可访问，但Nmap不能确定它是开放还是关闭。

  只有用于映射防火墙规则集的ACK扫描才会把端口分类到这种状态。

- open|filtered（开放或被过滤）：开放端口但不响应。也有可能是被过滤掉。

- closed|filtered（关闭或被过滤）：该状态用于Nmap不能确定端口是关闭的还是被过滤的。





