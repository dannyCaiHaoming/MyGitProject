#### 本地文件包含

###### 利用条件

1. 存在`include`，`require`等函数
2. 能控制参数带入到上面的函数

###### 常见用法

1. 读取敏感文件

如`etc/passwd`

2. 使用伪协议读取源码

```
php://filter/read=convert.base64-encode/resource=xxx.php
```

3. 包含含有shell的文件,

如果源码中包含有获取`.php`的文件，那么可以上传一个`.jpg`文件，使用中间件解析漏洞，尝试读取`.jgp.php`文件，使用`php`解析这个`jpg `文件

4. 包含Apache日志的Getshell

需要知道apache的日志文件`access.log`的存放位置，一般在`/var/log/httpd/access_log`。

使用`http://xxxx.com/<?php phpinfo ?>`访问，这个历史继续会写在日志文件。然后可以访问日志文件，就会触发文件包含漏洞。



#### 远程文件包含





#### 伪协议

一般的文件包含，感觉都会配合伪协议。

伪协议可以读写源码。可以看到源码中注解的`flag`，或者执行php的代码，得到目录结构，获取`flag文件名字`。



###### file://

访问本地文件系统，不受`allow_url_fopen`，和`allow_url_include`影响。



###### php://

用于访问输入、输出流。

```
# 执行php代码
php://input 
# 若有写入权限,可以写入一句话木马到文件。
<?php fput(fopen('shell.php','w'),'<?php @eval($_GET[cmd]); ?>'); ?>
# 读取源码
php://filter
php://stdin
php://memory
php://temp
```



###### zip:// & bzip2:// & zlib://

可以访问压缩文件中的子文件。

不需要指定后缀名？可修改为任意后缀`jpg,png,gif,xxx`??



###### data://

将文本以数据流封装传递，通常可以用来执行php代码。



###### phar://



###  题目：


###### 1. ctf.show_web3

