















#### 题目：



###### 1. ctf.show_红包题第六弹

尝试了一下的登录页的sql注入，时间盲注，都是没有回显，这里没有入口。

尝试了扫描目录，找到一个大概源码。然后结合页面的一些代码提示。

主要找到两个页面`login.php`和`check.php`。源码都找到的，里面也有一些文件的名字，我还猜怎么sql注入，然后正常跑通流程，太年轻。。

**提示：遇到一些文件名，可以直接尝试看看能不能访问或者下载**

```php
if(md5(date("i")) === $token){
	$receiveFile = 'flag.dat';
	receiveStreamFile($receiveFile);
	if(md5_file($receiveFile)===md5_file("key.dat")){
		if(hash_file("sha512",$receiveFile)!=hash_file("sha512","key.dat")){
```

源码中有三层提示:

1. 上传文件需要带上时间分钟值的`md5`
2. 会判断上传的文件的`md5`的值，是否等于`key.data`的`md5`值
3. 会判断上传的文件的`sha512`的值，是否等于`key.data`的`sha512`值

所以，要绕过最后一个判断，只有竞争条件，在判断的时候刚好上传了一个新的文件，得以绕过。

